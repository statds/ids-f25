<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sql</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="_sql_files/libs/clipboard/clipboard.min.js"></script>
<script src="_sql_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="_sql_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="_sql_files/libs/quarto-html/popper.min.js"></script>
<script src="_sql_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="_sql_files/libs/quarto-html/anchor.min.js"></script>
<link href="_sql_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="_sql_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="_sql_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="_sql_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="_sql_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Database operation with Structured query language (SQL)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section was prepared by Lewis Milun.</p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Structured Query Language (SQL) is one of the standard languages that is used to work with large databases. It uses tables to store and display data, creating an organized and comprehendable interface that makes it far easier to track and view your data.</p>
<p>Some advantages of using SQL include its ability to handle large amounts of data while simultaneously simplifying the process of screating, updating, and retrieving any data you may want.</p>
<p>The biggest advantage of using SQL for the purposes of this class, is that it can very easily connect with python and R. This makes it so that we can have all of the benefits of working with SQL while still working in the python environment we already have set up.</p>
</section>
<section id="setting-up-databases" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-databases">Setting up Databases</h3>
<p>In this section, we will be working with two databases, one that’s built into a python package (nycflights13) and one that we used for our midterm project (311 Service Requests)</p>
<section id="nycflights13" class="level4">
<h4 class="anchored" data-anchor-id="nycflights13">nycflights13</h4>
<p>This database is built into the pandas package and includes flight data for all flights that left New York City airports in 2013. The database includes several tables including ones that detail each flight, airline, airport, and much more info regarding the flights. The data in this database is contained across several tables. Data stored like this would typically be irritating to deal with however it is proven simple when working with SQL.</p>
<p>To set up this database, we need to import the proper packages:</p>
<div id="708b6408" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> flights, airlines, airports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\lewis\AppData\Roaming\Python\Python313\site-packages\nycflights13\__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  from pkg_resources import resource_filename as _rf</code></pre>
</div>
</div>
<p>Here we imported “sqlite3” which is the package to import when working with SQL. We also imported “pandas” which also includes the nycflights13 database and from there imported the three tables we will be working with.</p>
<p>Now, we want to establish the connection between python and our sql database:</p>
<div id="f3c7c90e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>nycconn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"nycflights13.db"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This snippet both creates the nycflights13.db database and establishes nycconn as our connection to this database.</p>
<p>Next step is to add the three tables we imported from nycflights13 to the database:</p>
<div id="603f49e3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>flights.to_sql(<span class="st">"flights"</span>, nycconn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>airlines.to_sql(<span class="st">"airlines"</span>, nycconn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>airports.to_sql(<span class="st">"airports"</span>, nycconn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>1458</code></pre>
</div>
</div>
<p>What this does is converts the three pandas dataframes into tables in the sql database. The if_exists argument handles what would happen if there is already a table in the database with the same name. The index argument is determining whether or not the first column of the dataframe should be handled as the index of the table in the dataframe.</p>
</section>
<section id="servicerequests-database" class="level4">
<h4 class="anchored" data-anchor-id="servicerequests-database">serviceRequests Database</h4>
<p>First, we need to import our serviceRequests data from the csv in the data folder:</p>
<div id="2c723d5b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"data/serviceRequests06-09-2025_07-05-2025.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we need to repeat the process from nycflights13 but for our serviceRequests:</p>
<div id="5ac243a0" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>srconn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"serviceRequests.db"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df.to_sql(<span class="st">"requests"</span>, srconn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>59382</code></pre>
</div>
</div>
<p>Here we imported the dataframe we got from the csv file as the only table in the serviceRequests.db database.</p>
</section>
</section>
<section id="query-basics" class="level3">
<h3 class="anchored" data-anchor-id="query-basics">Query Basics</h3>
<p>Now we can move onto working with the data in our SQL databases. The most common use for SQL is writing a “query” which is a statement sent to the SQL databse that returns a selection of rows and columns from the tables in a database.</p>
<p>We will be looking at the “flights” table in our nycflights13 database for this seciton.</p>
<section id="select-and-from" class="level4">
<h4 class="anchored" data-anchor-id="select-and-from">SELECT and FROM</h4>
<p>The following is the most basic possible query one can perform:</p>
<div id="f919d3e5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
<th data-quarto-table-cell-role="th">time_hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.0</td>
<td>515</td>
<td>2.0</td>
<td>830.0</td>
<td>819</td>
<td>11.0</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.0</td>
<td>1400</td>
<td>5</td>
<td>15</td>
<td>2013-01-01T10:00:00Z</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.0</td>
<td>529</td>
<td>4.0</td>
<td>850.0</td>
<td>830</td>
<td>20.0</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.0</td>
<td>1416</td>
<td>5</td>
<td>29</td>
<td>2013-01-01T10:00:00Z</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.0</td>
<td>540</td>
<td>2.0</td>
<td>923.0</td>
<td>850</td>
<td>33.0</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.0</td>
<td>1089</td>
<td>5</td>
<td>40</td>
<td>2013-01-01T10:00:00Z</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.0</td>
<td>545</td>
<td>-1.0</td>
<td>1004.0</td>
<td>1022</td>
<td>-18.0</td>
<td>B6</td>
<td>725</td>
<td>N804JB</td>
<td>JFK</td>
<td>BQN</td>
<td>183.0</td>
<td>1576</td>
<td>5</td>
<td>45</td>
<td>2013-01-01T10:00:00Z</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.0</td>
<td>600</td>
<td>-6.0</td>
<td>812.0</td>
<td>837</td>
<td>-25.0</td>
<td>DL</td>
<td>461</td>
<td>N668DN</td>
<td>LGA</td>
<td>ATL</td>
<td>116.0</td>
<td>762</td>
<td>6</td>
<td>0</td>
<td>2013-01-01T11:00:00Z</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This snippet represents the basic form of writing SQL queries in python. We create a variable ‘query’ that contains the statement we intend to pass into SQL. The last line then uses the nycconn connection we created earlier to pass our query into SQL and it returns the head() of the result we get back.</p>
<p>This query is the most basic query, as it returns the entire flights table. The SELECT line of the query is where you put the names of which columns you want from your table. You specify which table you want to work with on the FROM line. We put “*” in our SELECT line which returns all columns. All SQL queries must end with “;”, otherwise you’ll get an error.</p>
<p>Now let’s try to simplify what we’re seeing by only looking at the origins and destinations of the flights:</p>
<div id="aa8dfe50" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT origin, dest</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>IAH</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>LGA</td>
<td>IAH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>JFK</td>
<td>MIA</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>JFK</td>
<td>BQN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>LGA</td>
<td>ATL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we replaced the “*” in our SELECT statement with “origin, dest” This told SQL to only return those two columns from the database.</p>
</section>
<section id="order-by" class="level4">
<h4 class="anchored" data-anchor-id="order-by">ORDER BY</h4>
<p>These columns are quite messy to look at so let’s try sorting them by origin:</p>
<div id="4d067ab1" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT origin, dest</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>IAH</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>EWR</td>
<td>ORD</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>EWR</td>
<td>FLL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>EWR</td>
<td>SFO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>EWR</td>
<td>LAS</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we added a new “SORTBY” line. This line tells SQL what columns to sort the list by.</p>
<p>You can sort by multiple columns just by listing them with commas in between:</p>
<div id="96bfcd19" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT origin, dest</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>EWR</td>
<td>ALB</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="select-distinct" class="level4">
<h4 class="anchored" data-anchor-id="select-distinct">SELECT DISTINCT</h4>
<p>Now that the list is properly sorted, we can see that there are multiple flights from each origin to destination combination. If we want to only see the unique columns, we can do this:</p>
<div id="a3846e62" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT origin, dest</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>EWR</td>
<td>ANC</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>EWR</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>EWR</td>
<td>AUS</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>EWR</td>
<td>AVL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we replaced out “SELECT” statement with a “SELECT DISTINCT” statement. This tells SQL to only return the unique columns from the query.</p>
</section>
</section>
<section id="conditionals" class="level3">
<h3 class="anchored" data-anchor-id="conditionals">Conditionals</h3>
<p>Usually you wouldn’t want to just return all rows or all unique rows from a table You instead will have conditions that determine which rows are relevant to your query</p>
<section id="where" class="level4">
<h4 class="anchored" data-anchor-id="where">WHERE</h4>
<p>The way you can add conditionals to your query is by adding a “WHERE” line. Let’s take the same list from the last section and filter it so that only the flights that departed from LGA are returned:</p>
<div id="454a8ba6" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT origin, dest</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE origin = 'LGA'</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>LGA</td>
<td>AVL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>LGA</td>
<td>BGR</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>LGA</td>
<td>BHM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>LGA</td>
<td>BNA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>You add conditionals in the “WHERE” line by using the following comparators: - = - &lt; - &gt; - &lt;= - &gt;= - !=</p>
<p>Be careful of the type of the data in a particular column!</p>
</section>
<section id="and-or-and-not" class="level4">
<h4 class="anchored" data-anchor-id="and-or-and-not">AND, OR, and NOT</h4>
<p>You can add multiple conditionals by using AND, OR, and parenthesis</p>
<div id="fd911087" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT origin, dest</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE origin = 'LGA' AND dest = 'ATL'</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>LGA</td>
<td>ATL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This uses AND to return all flights that departed from LGA and arrived in ATL</p>
<p>We can also use OR to return all flights that either departed from LGA or arrived in ATL:</p>
<div id="434eca59" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT origin, dest</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE origin = 'LGA' OR dest = 'ATL'</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>JFK</td>
<td>ATL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>LGA</td>
<td>ATL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>LGA</td>
<td>AVL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>LGA</td>
<td>BGR</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>When you want to get more complicated with your conditionals, parenthesis can be used to ensure SQL is correctly mixing the AND and OR statements.</p>
<p>Use NOT to return the opposite of a statement:</p>
<div id="407de721" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT origin, dest</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE NOT (origin = 'LGA' OR dest = 'ATL')</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>ALB</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>EWR</td>
<td>ANC</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>EWR</td>
<td>AUS</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>EWR</td>
<td>AVL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>EWR</td>
<td>BDL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="count" class="level4">
<h4 class="anchored" data-anchor-id="count">COUNT</h4>
<p>An easy way in SQL to see the total number of rows that fit the conditions you’ve specified:</p>
<div id="9c2a329c" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(DISTINCT dest)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE NOT (origin = 'LGA' OR dest = 'ATL')</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">COUNT(DISTINCT dest)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>97</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This returns the number of distinct destinations that fit the specified criteria</p>
</section>
<section id="limit" class="level4">
<h4 class="anchored" data-anchor-id="limit">LIMIT</h4>
<p>If you don’t want to use .head() to only display the first few rows, this can be done in SQL using a LIMIT statement:</p>
<div id="70b1cb27" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT carrier, origin, dest</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE carrier = 'UA'</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>UA</td>
<td>EWR</td>
<td>ANC</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>UA</td>
<td>EWR</td>
<td>ATL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>UA</td>
<td>EWR</td>
<td>AUS</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>UA</td>
<td>EWR</td>
<td>BDL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UA</td>
<td>EWR</td>
<td>BOS</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This query added the “carrier” column that displays the airline that held the flight. We specified that we want all flights from the “UA” airline and limited the result to 5 rows.</p>
<p>An interesting thing you can do with conditionals in SQL is to filter by values in a column that you are not displaying:</p>
<div id="7b522fa2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT origin, dest</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE carrier = 'UA'</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY origin, dest</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EWR</td>
<td>ANC</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>EWR</td>
<td>ATL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>EWR</td>
<td>AUS</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>EWR</td>
<td>BDL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>EWR</td>
<td>BOS</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we still filter by flights from the “UA” airline but we don’t display the column as that would be very redundant.</p>
</section>
</section>
<section id="joins" class="level3">
<h3 class="anchored" data-anchor-id="joins">Joins</h3>
<p>The last query that we did was useful, however it isn’t realistic to expect users to memorize the two digit codes for all airlines. Thankfully, there is the airlines table in our nycflights13.db database. Let’s take a look at it:</p>
<div id="bc0314f7" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM airlines;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9E</td>
<td>Endeavor Air Inc.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>AA</td>
<td>American Airlines Inc.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AS</td>
<td>Alaska Airlines Inc.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>B6</td>
<td>JetBlue Airways</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>DL</td>
<td>Delta Air Lines Inc.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This table is much simpler than the “flights” table as it only has two columns.</p>
<section id="inner-join" class="level4">
<h4 class="anchored" data-anchor-id="inner-join">INNER JOIN</h4>
<p>Logically, we wouldn’t want our outputted table to display the two digit code that represents each airline but instead we’d want to see the name of the airline. Thankfully, SQL has a way to join the data from the two tables together:</p>
<div id="df7735f4" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT a.name AS airline_name, f.origin, f.dest</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights AS f</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airlines AS a</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">ON f.carrier = a.carrier;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">airline_name</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>United Air Lines Inc.</td>
<td>EWR</td>
<td>IAH</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>United Air Lines Inc.</td>
<td>LGA</td>
<td>IAH</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>American Airlines Inc.</td>
<td>JFK</td>
<td>MIA</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>JetBlue Airways</td>
<td>JFK</td>
<td>BQN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Delta Air Lines Inc.</td>
<td>LGA</td>
<td>ATL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This is a much more complicated query that returns a table of the distinct airline, origin, and destinations in the flights database. We introduced three new statements in this query: - AS is similar to how “as” is used when importing packages in python. It gives us an opportunity to use a shorthand instead of needing to type out the full table names every time we mention a column. It can also be used in our SELECT line to name columns in our resultant table - INNER JOIN connects a new table to our query (in this case, the new table is airlines). - ON lets SQL know what column in each table it should use to connect the tables. Here we told SQL that in every row, when it reaches the carrier column in flights, it should use that as its reference for what row in airlines to use for values in this row. For example, in the first row, SQL saw that the carrier name in flights was “UA”. SQL then looked in the carrier column in airlines and found the row in which “UA” was the value in that table’s carrier column. So when SQL was calculating the value for airline_name in the first row, it knew which column to search in airline to find “United Air Lines Inc.”</p>
<p>JOIN statements are key when using SQL to display data. This is what allows SQL databases to be in such nice and concise forms.</p>
<p>Now let’s also add in the values from the “airports” table so that we get the full names of the airports instead of their three digit codes:</p>
<div id="2b214b86" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT a.name AS airline_name,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">       orig.name AS origin_name,</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">       dest.name AS dest_name</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights AS f</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airlines AS a</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.carrier = a.carrier</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airports AS orig</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.origin = orig.faa</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airports AS dest</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.dest = dest.faa;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">airline_name</th>
<th data-quarto-table-cell-role="th">origin_name</th>
<th data-quarto-table-cell-role="th">dest_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>United Air Lines Inc.</td>
<td>Newark Liberty Intl</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>United Air Lines Inc.</td>
<td>La Guardia</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>American Airlines Inc.</td>
<td>John F Kennedy Intl</td>
<td>Miami Intl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Delta Air Lines Inc.</td>
<td>La Guardia</td>
<td>Hartsfield Jackson Atlanta Intl</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>United Air Lines Inc.</td>
<td>Newark Liberty Intl</td>
<td>Chicago Ohare Intl</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here we use three different INNER JOIN statements to connect the two tables properly. The reason we use two JOIN statements to connect the same “airports” table is to have SQL be able to look separately for the origin and destination airport names. This query also utilizes indenting to make the query far more readable.</p>
</section>
<section id="the-difference-between-the-three-joins" class="level4">
<h4 class="anchored" data-anchor-id="the-difference-between-the-three-joins">The difference between the three JOINs</h4>
<p>SQL has three different versions of JOIN statements: - INNER JOIN - LEFT JOIN - RIGHT JOIN</p>
<p>This allows the user to determine what rows get included as a result of joining two tables. Let’s take a look at the differences: ##### INNER JOIN</p>
<div id="f8de0997" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT f.flight,</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">       a.name AS airline_name,</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">       orig.name AS origin_name,</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">       dest.name AS dest_name</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights AS f</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airlines AS a</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.carrier = a.carrier</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airports AS orig</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.origin = orig.faa</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN airports AS dest</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.dest = dest.faa;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">airline_name</th>
<th data-quarto-table-cell-role="th">origin_name</th>
<th data-quarto-table-cell-role="th">dest_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1545</td>
<td>United Air Lines Inc.</td>
<td>Newark Liberty Intl</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1714</td>
<td>United Air Lines Inc.</td>
<td>La Guardia</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1141</td>
<td>American Airlines Inc.</td>
<td>John F Kennedy Intl</td>
<td>Miami Intl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>461</td>
<td>Delta Air Lines Inc.</td>
<td>La Guardia</td>
<td>Hartsfield Jackson Atlanta Intl</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1696</td>
<td>United Air Lines Inc.</td>
<td>Newark Liberty Intl</td>
<td>Chicago Ohare Intl</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>INNER JOIN is the most common. This is because the result will only include rows in which the values in question are included in both tables. For example, if there was a row in flights that included an airline code that was not present in airlines, then SQL will not include that row in the result.</p>
<section id="left-join" class="level5">
<h5 class="anchored" data-anchor-id="left-join">LEFT JOIN</h5>
<div id="d5373d17" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT f.flight,</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">    a.name AS airline_name,</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">    orig.name AS origin_name,</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">    dest.name AS dest_name</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights AS f</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN airlines AS a</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.carrier = a.carrier</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN airports AS orig</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.origin = orig.faa</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN airports AS dest</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.dest = dest.faa;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">airline_name</th>
<th data-quarto-table-cell-role="th">origin_name</th>
<th data-quarto-table-cell-role="th">dest_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1545</td>
<td>United Air Lines Inc.</td>
<td>Newark Liberty Intl</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1714</td>
<td>United Air Lines Inc.</td>
<td>La Guardia</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1141</td>
<td>American Airlines Inc.</td>
<td>John F Kennedy Intl</td>
<td>Miami Intl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>725</td>
<td>JetBlue Airways</td>
<td>John F Kennedy Intl</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>461</td>
<td>Delta Air Lines Inc.</td>
<td>La Guardia</td>
<td>Hartsfield Jackson Atlanta Intl</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>LEFT JOIN will return all rows that are in flights regardless of if SQL was able to find matching rows on the other tables. This is perfectly represented in the fourth row of the output. On flights, the destination for flight 725 is “BQN” which is not an airport on the airports table. If you look back to the result of the INNER JOIN, this row was removed from the result however it is present here because we used flights as our only reference for rows and therefore the row is included but the destination name is left as “None”</p>
</section>
<section id="right-join" class="level5">
<h5 class="anchored" data-anchor-id="right-join">RIGHT JOIN</h5>
<div id="fb442b3b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT f.flight,</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="st">    f.origin,</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="st">    dest.name AS dest_name</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM flights AS f</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">RIGHT JOIN airports AS dest</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">    ON f.dest = dest.faa;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query, nycconn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1545.0</td>
<td>EWR</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1714.0</td>
<td>LGA</td>
<td>George Bush Intercontinental</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1141.0</td>
<td>JFK</td>
<td>Miami Intl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>461.0</td>
<td>LGA</td>
<td>Hartsfield Jackson Atlanta Intl</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1696.0</td>
<td>EWR</td>
<td>Chicago Ohare Intl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13275</td>
<td>NaN</td>
<td>None</td>
<td>Boston Back Bay Station</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13276</td>
<td>NaN</td>
<td>None</td>
<td>Black Rock</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13277</td>
<td>NaN</td>
<td>None</td>
<td>New Haven Rail Station</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13278</td>
<td>NaN</td>
<td>None</td>
<td>Wilmington Amtrak Station</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13279</td>
<td>NaN</td>
<td>None</td>
<td>Washington Union Station</td>
</tr>
</tbody>
</table>

<p>13280 rows × 3 columns</p>
</div>
</div>
</div>
<p>RIGHT JOIN is basically the opposite of LEFT JOIN. Instead of using flights as its basis for what rows to include, RIGHT JOIN uses the joined tables instead. As you can see, the fourth row is being skipped again because the airports table is being used as reference instead. Also, the table ends with rows for all destinations from the airports table. SQL includes them because it is looking for all rows that include destinations from the airports table. This includes all rows from the airports table itself.</p>
</section>
</section>
</section>
<section id="creating-tables" class="level3">
<h3 class="anchored" data-anchor-id="creating-tables">Creating Tables</h3>
<p>Put links to further materials.</p>
</section>
<section id="statement-order" class="level3">
<h3 class="anchored" data-anchor-id="statement-order">Statement Order</h3>
<p>Statements in a SQL query must go in a certain order, otherwise the query will return an error. The order is as follows: - SELECT - FROM - JOIN - WHERE - GROUP BY - HAVING - ORDER BY - LIMIT/OFFSET</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
</section>
<section id="further-readings" class="level3">
<h3 class="anchored" data-anchor-id="further-readings">Further Readings</h3>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>